/* Show_NTD.C*/

{

/////////////////////////////////////////////////////////////////////////////
//                                                                         // 
// Open histogram files                                                    //
//                                                                         // 
/////////////////////////////////////////////////////////////////////////////


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////    

  char file_name[ ] = "../../Data_COV/2021_05_12_17_27_27/2021_05_12_17_27_27_new.root";

  //  TFile *f_01 = new TFile("MyCOV1.root");
  TFile *f_01 = new TFile(file_name);
//  TFile *f_02 = new TFile("/sps/t2k/edoardo/COV/MyCOV1_2.root");
//  TFile *f_03 = new TFile("/sps/t2k/edoardo/COV/MyCOV1_3.root");

  f_01->cd();
 
  Double_t RunTime = h1_RunTime->GetBinContent(1);
  cout << " RunTime = " << RunTime << "s" << endl;
  Double_t NTD_Gain = h1_Gains->GetBinContent(3);
  Double_t NTD_Threshold = h1_Thresholds->GetBinContent(3);

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////
//                                                                         // 
// Canvas 001 :                                                            //
//                                                                         // 
/////////////////////////////////////////////////////////////////////////////

  cout << " ++++++++++++++++++++++++ " << endl;
  cout << " ++++++ Canvas 001 ++++++ " << endl;
  cout << " ++++++++++++++++++++++++ " << endl;

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	
  TCanvas *C_001 = new TCanvas("C_001","C_001: ", 1000,600);
//  C_00s1->Divide(2,2);

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  gStyle->SetOptFit(000000);
  gStyle->SetOptStat("000000001");

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  TH1F *h1_Raw_NTD_1, *h1_Raw_NTD_copy, *h1_Raw_NTD_2, *h1_Dif_NTD_1, *h1_Dif_NTD_2;

//  C_001->cd(1);

  h1_Raw_NTD_copy = (TH1F*) h1_NTD->Clone();

    int Nbins = h1_Raw_NTD_copy->FindBin(43200.)-h1_Raw_NTD_copy->FindBin(38200.);
    int first = h1_Raw_NTD_copy->FindBin(38200.);
  h1_Raw_NTD_1 = new TH1F("h1_Raw_NTD_1","h1_Raw_NTD_1", Nbins, 0, 5);

    for (int i =0; i<Nbins; i++){
        h1_Raw_NTD_1->SetBinContent(i, -h1_Raw_NTD_copy->GetBinContent(first+i));
    }

  h1_Raw_NTD_1->GetXaxis()->SetTitle("T [s]");
  h1_Raw_NTD_1->GetYaxis()->SetTitle("Amplitude [V]");
//  h1_Raw_NTD_1->GetXaxis()->SetRangeUser(38400.,39400.);
//  h1_Raw_NTD_1->GetYaxis()->SetRangeUser( -4.0, 1.);
  h1_Raw_NTD_1->SetLineColor(4);
  h1_Raw_NTD_1->SetLineWidth(2);
  h1_Raw_NTD_1->Draw();

  TLegend *Legend_001_1 = new TLegend(.65,.15,.85,.30);
  Legend_001_1->SetFillColor(0);
  Legend_001_1->SetBorderSize(5);
  Legend_001_1->AddEntry(h1_Raw_NTD_1,"NTD","L");
  Legend_001_1->Draw();

  C_001->cd(2);

  h1_Raw_NTD_2 = (TH1F*)h1_NTD->Clone();
  h1_Raw_NTD_2->GetXaxis()->SetTitle("T [ms]");
  h1_Raw_NTD_2->GetYaxis()->SetTitle("Amplitude [V]");
  h1_Raw_NTD_2->GetXaxis()->SetRangeUser(38900.,39100.);
  h1_Raw_NTD_2->GetYaxis()->SetRangeUser( .0, 0.6);
  h1_Raw_NTD_2->SetLineColor(4);
  h1_Raw_NTD_2->SetLineWidth(2);
  h1_Raw_NTD_2->Draw();

  TLegend *Legend_001_2 = new TLegend(.65,.15,.85,.30);
  Legend_001_2->SetFillColor(0);
  Legend_001_2->SetBorderSize(5);
  Legend_001_2->AddEntry(h1_Raw_NTD_2,"NTD","L");
  Legend_001_2->Draw();

  C_001->cd(3);

  h1_Dif_NTD_1 = (TH1F*)h1_DIF_NTD->Clone();
  h1_Dif_NTD_1->GetXaxis()->SetTitle("T [ms]");
  h1_Dif_NTD_1->GetYaxis()->SetTitle("#DeltaAmplitude [V]");
  h1_Dif_NTD_1->GetXaxis()->SetRangeUser(38400.,39400.);
  h1_Dif_NTD_1->GetYaxis()->SetRangeUser( -0.1, 0.5);
  h1_Dif_NTD_1->SetLineColor(4);
  h1_Dif_NTD_1->SetLineWidth(2);
  h1_Dif_NTD_1->Draw();

  TLegend *Legend_001_3 = new TLegend(.65,.70,.85,.85);
  Legend_001_3->SetFillColor(0);
  Legend_001_3->SetBorderSize(5);
  Legend_001_3->AddEntry(h1_Dif_NTD_1,"NTD","L");
  Legend_001_3->Draw();

  C_001->cd(4);

  h1_Dif_NTD_2 = (TH1F*)h1_DIF_NTD->Clone();
  h1_Dif_NTD_2->GetXaxis()->SetTitle("T [ms]");
  h1_Dif_NTD_2->GetYaxis()->SetTitle("#DeltaAmplitude [V]");
  h1_Dif_NTD_2->GetXaxis()->SetRangeUser(38900.,39100.);
  h1_Dif_NTD_2->GetYaxis()->SetRangeUser(-0.01,0.04);
  h1_Dif_NTD_2->SetLineColor(4);
  h1_Dif_NTD_2->SetLineWidth(2);
  h1_Dif_NTD_2->Draw();

  TLegend *Legend_001_4 = new TLegend(.65,.70,.85,.85);
  Legend_001_4->SetFillColor(0);
  Legend_001_4->SetBorderSize(5);
  Legend_001_4->AddEntry(h1_Dif_NTD_2,"NTD","L");
  Legend_001_4->Draw();

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////
//                                                                         //
// Canvas 002 :                                                            //
//                                                                         //
/////////////////////////////////////////////////////////////////////////////

  cout << " ++++++++++++++++++++++++ " << endl;
  cout << " ++++++ Canvas 002 ++++++ " << endl;
  cout << " ++++++++++++++++++++++++ " << endl;

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  TCanvas *C_002 = new TCanvas("C_002","C_002: ", 1000,600);
  C_002->Divide(1,1);
  C_002->SetLogy();

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  gStyle->SetOptFit(000000);
  gStyle->SetOptStat("000000001");

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  h1_NTD_Amplitude->GetXaxis()->SetTitle("Amplitude [V]");
  h1_NTD_Amplitude->GetYaxis()->SetTitle("Counts / 5 mV");
  h1_NTD_Amplitude->GetXaxis()->SetRangeUser(  0.,  1.5);
  h1_NTD_Amplitude->GetYaxis()->SetRangeUser( .1, 10000.);
  h1_NTD_Amplitude->SetLineColor(4);
  h1_NTD_Amplitude->SetLineWidth(2);
  h1_NTD_Amplitude->Draw();

  TLegend *Legend_002 = new TLegend(.70,.70,.85,.85);
  Legend_002->SetFillColor(0);
  Legend_002->SetBorderSize(5);
  Legend_002->AddEntry(h1_NTD_Amplitude,"NTD","L");
  Legend_002->Draw();

  Double_t Cal_NTD = .236;

  TLatex *Latex_002_1 = new TLatex(1.4*511.*Cal_NTD/1000., 800.,"511 keV");
  Latex_002_1->SetTextSize(.030);
  Latex_002_1->SetTextColor(1);
  Latex_002_1->SetTextAlign(22);
  Latex_002_1->Draw();

  TLatex *Latex_002_2 = new TLatex(1461.*Cal_NTD/1000., 240.,"1461 keV");
  Latex_002_2->SetTextSize(.030);
  Latex_002_2->SetTextColor(1);
  Latex_002_2->SetTextAlign(22);
  Latex_002_2->Draw();

  TLatex *Latex_002_3 = new TLatex(2615.*Cal_NTD/1000.,  80.,"2615 keV");
  Latex_002_3->SetTextSize(.030);
  Latex_002_3->SetTextColor(1);
  Latex_002_3->SetTextAlign(22);
  Latex_002_3->Draw();

  TLatex *Latex_002_4 = new TLatex(5600.*Cal_NTD/1000.,60.,"^{6}Li(n,t)#alpha");
  Latex_002_4->SetTextSize(.030);
  Latex_002_4->SetTextColor(1);
  Latex_002_4->SetTextAlign(22);
  Latex_002_4->Draw();

  cout << " Data entries = " << h1_NTD_Amplitude->GetEntries() << " " << endl;
  cout << " NTD rate (cps) = " << h1_NTD_Amplitude->GetEntries()/RunTime << " +/- " << sqrt(h1_NTD_Amplitude->GetEntries())/RunTime << " " << endl;

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////
//                                                                         //
// Canvas 003 :                                                            //
//                                                                         //
/////////////////////////////////////////////////////////////////////////////

  cout << " ++++++++++++++++++++++++ " << endl;
  cout << " ++++++ Canvas 003 ++++++ " << endl;
  cout << " ++++++++++++++++++++++++ " << endl;

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  TCanvas *C_003 = new TCanvas("C_003","C_003: ", 1000,600);
  C_003->Divide(3,1);

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  gStyle->SetOptFit(000000);
  gStyle->SetOptStat("000000001");

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  TH1F *h1_Peak_0511, *h1_Peak_1461, *h1_Peak_2615;
  Double_t NTD_Cal_M[3], NTD_Cal_S[3], NTD_Res_M[3], NTD_Res_S[3];

  C_003->cd(1);

  h1_Peak_0511 = (TH1F*)h1_NTD_Amplitude->Clone();
  h1_Peak_0511->GetXaxis()->SetTitle("Amplitude [V]");
  h1_Peak_0511->GetYaxis()->SetTitle("Counts / 5 mV");
  h1_Peak_0511->GetXaxis()->SetRangeUser(0.090,0.135);
  h1_Peak_0511->GetYaxis()->SetRangeUser(0.,1200.);
  h1_Peak_0511->GetYaxis()->SetTitleOffset(1.5);
  h1_Peak_0511->SetLineColor(4);
  h1_Peak_0511->SetLineWidth(2);

  TF1 *fit_0511 = new TF1("fit_0511","expo+gaus(2)",0.090,0.135);

  fit_0511->SetParameters(7.,-16.,40.,0.117,0.020);
  h1_Peak_0511->Fit("fit_0511","R");

  NTD_Cal_M[0] = fit_0511->GetParameter(3);
  NTD_Cal_S[0] = fit_0511->GetParError(3);
  NTD_Res_M[0] = fit_0511->GetParameter(4);
  NTD_Res_S[0] = fit_0511->GetParError(4);

  /*
  TLegend *Legend_003_1 = new TLegend(.65,.70,.85,.85);
  Legend_003_1->SetFillColor(0);
  Legend_003_1->SetBorderSize(5);
  Legend_003_1->AddEntry(h1_Peak2,"Ge BOT","L");
  Legend_003_1->Draw();

  TLatex *Latex_003_1 = new TLatex( .45, 640.,"511 keV");
  Latex_003_1->SetTextSize(.050);
  Latex_003_1->SetTextColor(1);
  Latex_003_1->SetTextAlign(22);
  Latex_003_1->Draw();
  */

  C_003->cd(2);

  h1_Peak_1461 = (TH1F*)h1_NTD_Amplitude->Clone();
  h1_Peak_1461->GetXaxis()->SetTitle("Amplitude [V]");
  h1_Peak_1461->GetYaxis()->SetTitle("Counts / 2 mV");
  h1_Peak_1461->GetXaxis()->SetRangeUser(0.26,0.42);
  h1_Peak_1461->GetYaxis()->SetRangeUser(  0.,200.);
  h1_Peak_1461->GetYaxis()->SetTitleOffset(1.5);
  h1_Peak_1461->SetLineColor(4);
  h1_Peak_1461->SetLineWidth(2);

  TF1 *fit_1461 = new TF1("fit_1461","expo+gaus(2)",0.26,0.42);

  fit_1461->SetParameters(5.8,-8.4,60.,0.35,0.003);
  h1_Peak_1461->Fit("fit_1461","R");

  NTD_Cal_M[1] = fit_1461->GetParameter(3);
  NTD_Cal_S[1] = fit_1461->GetParError(3);
  NTD_Res_M[1] = fit_1461->GetParameter(4);
  NTD_Res_M[1] = fit_1461->GetParError(4);


  /*
  TLegend *Legend_003_2 = new TLegend(.65,.70,.85,.85);
  Legend_003_2->SetFillColor(0);
  Legend_003_2->SetBorderSize(5);
  Legend_003_2->AddEntry(h1_Peak2,"Ge BOT","L");
  Legend_003_2->Draw();

  TLatex *Latex_003_2 = new TLatex(1.31, 160.,"1461 keV");
  Latex_003_2->SetTextSize(.050);
  Latex_003_2->SetTextColor(1);
  Latex_003_2->SetTextAlign(22);
  Latex_003_2->Draw();
  */

  C_003->cd(3);

  h1_Peak_2615 = (TH1F*)h1_NTD_Amplitude->Clone();
  h1_Peak_2615->GetXaxis()->SetTitle("Amplitude [V]");
  h1_Peak_2615->GetYaxis()->SetTitle("Counts / 2 mV");
  h1_Peak_2615->GetXaxis()->SetRangeUser(0.56,0.68);
  h1_Peak_2615->GetYaxis()->SetRangeUser(  0., 60.);
  h1_Peak_2615->GetYaxis()->SetTitleOffset(1.5);
  h1_Peak_2615->SetLineColor(4);
  h1_Peak_2615->SetLineWidth(2);

  TF1 *fit_2615 = new TF1("fit_2615","expo+gaus(2)",0.56,0.68);

  fit_2615->SetParameters(3.8,-4.,17.,0.62,0.003);
  h1_Peak_2615->Fit("fit_2615","R");

  NTD_Cal_M[2] = fit_2615->GetParameter(3);
  NTD_Cal_S[2] = fit_2615->GetParError(3);
  NTD_Res_M[2] = fit_2615->GetParameter(4);
  NTD_Res_M[2] = fit_2615->GetParError(4);


  /*
  TLegend *Legend_003_3 = new TLegend(.65,.70,.85,.85);
  Legend_003_3->SetFillColor(0);
  Legend_003_3->SetBorderSize(5);
  Legend_003_3->AddEntry(h1_Peak2,"Ge BOT","L");
  Legend_003_3->Draw();

  TLatex *Latex_003_3 = new TLatex(2.36,  48.,"2615 keV");
  Latex_003_3->SetTextSize(.050);
  Latex_003_3->SetTextColor(1);
  Latex_003_3->SetTextAlign(22);
  Latex_003_3->Draw();
  */

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////
//                                                                         //
// Canvas 004 :                                                            //
//                                                                         //
/////////////////////////////////////////////////////////////////////////////

  cout << " ++++++++++++++++++++++++ " << endl;
  cout << " ++++++ Canvas 004 ++++++ " << endl;
  cout << " ++++++++++++++++++++++++ " << endl;

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  TCanvas *C_004 = new TCanvas("C_004","C_004: ", 1000,600);
  C_004->Divide(1,1);

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  gStyle->SetOptFit(001111);
  gStyle->SetOptStat("000000001");

  TH1F *Frame_004 = C_004->DrawFrame(0., 0., 3000., 1.);

  Frame_004->GetXaxis()->SetTitle("E [keV]");
  Frame_004->GetYaxis()->SetTitle("Amplitude [V]");

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  Double_t Eg[3]         = {  511.00, 1460.83, 2614.53};

  Int_t nn1 = 3;
  Double_t xx1[10], yy1[10], ex1[10], ey1[10];

  for (Int_t j = 0; j < nn1; j++) {
    xx1[j] = Eg[j];
    ex1[j] =    0.;
    yy1[j] = NTD_Cal_M[j];
    ey1[j] = NTD_Cal_S[j];
  }

  TGraphErrors *NTD_Cal = new TGraphErrors(nn1,xx1,yy1,ex1,ey1);
  NTD_Cal->SetMarkerColor(4);
  NTD_Cal->SetMarkerStyle(20);
  NTD_Cal->SetMarkerSize(1.4);
  NTD_Cal->Draw("P");

  TF1 *fit_01 = new TF1("fit_01","pol1",0.,3000.);
  fit_01->SetRange(0.,3000.);
  fit_01->SetParameters(0.,0.00024);
  fit_01->SetLineStyle(2);

  Double_t NTD_Cal_OffSet = fit_01->GetParameter(0);
  Double_t NTD_Cal_Slope = fit_01->GetParameter(1);

  NTD_Cal->Fit("fit_01","R");

  Double_t NTD_Conv = fit_01->GetParameter(1);

  TLegend *Legend_004 = new TLegend(.15,.60,.45,.80);
  Legend_004->SetFillColor(0);
  Legend_004->SetBorderSize(5);
  Legend_004->AddEntry(NTD_Cal,"NTD","P");
  Legend_004->Draw();

  TLatex *Latex_004_1 = new TLatex(2200.,0.3,"236 #muV/keV");
  Latex_004_1->SetTextSize(.060);
  Latex_004_1->SetTextColor(1);
  Latex_004_1->SetTextAlign(22);
  Latex_004_1->Draw();

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////
//                                                                         //
// Canvas 005 :                                                            //
//                                                                         //
/////////////////////////////////////////////////////////////////////////////

  cout << " ++++++++++++++++++++++++ " << endl;
  cout << " ++++++ Canvas 005 ++++++ " << endl;
  cout << " ++++++++++++++++++++++++ " << endl;

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  TCanvas *C_005 = new TCanvas("C_005","C_005: ", 1000,600);
  C_005->Divide(1,1);

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  gStyle->SetOptFit(000000);
  gStyle->SetOptStat("000000001");

  TH1F *Frame_005 = C_005->DrawFrame(0., 0., 3000., 5.);

  Frame_005->GetXaxis()->SetTitle("E [keV]");
  //Frame_005->GetYaxis()->SetTitle("E Resolution (FWHM) [keV]");
  Frame_005->GetYaxis()->SetTitle("#sigma_{E} / E [%]");

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  for (Int_t j = 0; j < nn1; j++) {
    xx1[j] = Eg[j];
    ex1[j] =    0.;
    yy1[j] = 2.*sqrt(log(4.))*NTD_Res_M[j]/NTD_Conv;
    ey1[j] = 2.*sqrt(log(4.))*NTD_Res_S[j]/NTD_Conv;
    yy1[j] = 100.*NTD_Res_M[j]/NTD_Conv/Eg[j];
    ey1[j] = 100.*NTD_Res_S[j]/NTD_Conv/Eg[j];
  }

  TGraphErrors *NTD_Res = new TGraphErrors(nn1,xx1,yy1,ex1,ey1);
  NTD_Res->SetMarkerColor(1);
  NTD_Res->SetMarkerStyle(20);
  NTD_Res->SetMarkerSize(1.4);
  NTD_Res->Draw("P");
  /*
  TLegend *Legend_005 = new TLegend(.15,.60,.45,.80);
  Legend_005->SetFillColor(0);
  Legend_005->SetBorderSize(5);
  Legend_005->AddEntry(COV1_Res,"Ge BOT","P");
  Legend_005->AddEntry(COV2_Res,"Ge TOP","P");
  Legend_005->Draw();
  */

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////
////                                                                         //
//// Canvas 006 :                                                            //
////                                                                         //
///////////////////////////////////////////////////////////////////////////////
//
//  cout << " ++++++++++++++++++++++++ " << endl;
//  cout << " ++++++ Canvas 006 ++++++ " << endl;
//  cout << " ++++++++++++++++++++++++ " << endl;
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  TCanvas *C_006 = new TCanvas("C_006","C_006: ", 1000,600);
//  C_006->Divide(1,1);
//  C_006->SetLogy();
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  gStyle->SetOptFit(000000);
//  gStyle->SetOptStat("000000001");
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  h1_NTD_Amplitude_keV->GetXaxis()->SetTitle("E [keV]");
//  h1_NTD_Amplitude_keV->GetYaxis()->SetTitle("Counts / bin");
//  h1_NTD_Amplitude_keV->GetXaxis()->SetRangeUser(  0.,  7000.0);
//  h1_NTD_Amplitude_keV->GetYaxis()->SetRangeUser(  1.0, 10000.);
//  h1_NTD_Amplitude_keV->SetLineColor(4);
//  h1_NTD_Amplitude_keV->SetLineWidth(2);
//  h1_NTD_Amplitude_keV->Draw();
//
//  TLegend *Legend_006 = new TLegend(.55,.65,.85,.85);
//  Legend_006->SetFillColor(0);
//  Legend_006->SetBorderSize(5);
//  Legend_006->AddEntry(h1_Peak1,"NTD","L");
//  Legend_006->Draw();
//
//  TLatex *Latex_006_1 = new TLatex( 1.4*511.,800.,"511 keV");
//  Latex_006_1->SetTextSize(.030);
//  Latex_006_1->SetTextColor(1);
//  Latex_006_1->SetTextAlign(22);
//  Latex_006_1->Draw();
//
//  TLatex *Latex_006_2 = new TLatex(1461.,300.,"1461 keV");
//  Latex_006_2->SetTextSize(.030);
//  Latex_006_2->SetTextColor(1);
//  Latex_006_2->SetTextAlign(22);
//  Latex_006_2->Draw();
//
//  TLatex *Latex_006_3 = new TLatex(2615., 100.,"2615 keV");
//  Latex_006_3->SetTextSize(.030);
//  Latex_006_3->SetTextColor(1);
//  Latex_006_3->SetTextAlign(22);
//  Latex_006_3->Draw();
//
//  TLatex *Latex_006_4 = new TLatex(5600.,50.,"^{6}Li(n,t)#alpha");
//  Latex_006_4->SetTextSize(.030);
//  Latex_006_4->SetTextColor(1);
//  Latex_006_4->SetTextAlign(22);
//  Latex_006_4->Draw();
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////
////                                                                         //
//// Canvas 007 :                                                            //
////                                                                         //
///////////////////////////////////////////////////////////////////////////////
//
//  cout << " ++++++++++++++++++++++++ " << endl;
//  cout << " ++++++ Canvas 007 ++++++ " << endl;
//  cout << " ++++++++++++++++++++++++ " << endl;
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  TCanvas *C_007 = new TCanvas("C_007","C_007: ", 1000,600);
//  C_007->Divide(1,1);
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  gStyle->SetOptFit(000000);
//  gStyle->SetOptStat("000000001");
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  h1_BSL_NTD_M->GetXaxis()->SetTitle("BSL Mean [keV]");
//  h1_BSL_NTD_M->GetYaxis()->SetTitle("Counts / .02 keV");
//  h1_BSL_NTD_M->GetXaxis()->SetRangeUser(-2.0,  2.0);
//  h1_BSL_NTD_M->GetYaxis()->SetRangeUser(  0.,  60.);
//  h1_BSL_NTD_M->SetLineColor(4);
//  h1_BSL_NTD_M->SetLineWidth(2);
//  h1_BSL_NTD_M->Draw();
//
//  TLegend *Legend_007 = new TLegend(.15,.70,.30,.85);
//  Legend_007->SetFillColor(0);
//  Legend_007->SetBorderSize(5);
//  Legend_007->AddEntry(h1_BSL_NTD_M,"NTD","L");
//  Legend_007->Draw();
//
//  cout << " Data entries = " << h1_BSL_NTD_M->GetEntries() << " " << endl;
//  cout << " NTD rate (cps) = " << h1_BSL_NTD_M->GetEntries()/RunTime << " +/- " << sqrt(h1_BSL_NTD_M->GetEntries())/RunTime << " " << endl;
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////
////                                                                         //
//// Canvas 008 :                                                            //
////                                                                         //
///////////////////////////////////////////////////////////////////////////////
//
//  cout << " ++++++++++++++++++++++++ " << endl;
//  cout << " ++++++ Canvas 008 ++++++ " << endl;
//  cout << " ++++++++++++++++++++++++ " << endl;
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  TCanvas *C_008 = new TCanvas("C_008","C_008: ", 1000,600);
//  C_008->Divide(1,1);
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  gStyle->SetOptFit(000000);
//  gStyle->SetOptStat("000000001");
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  h1_BSL_NTD_S->GetXaxis()->SetTitle("BSL RMS [keV]");
//  h1_BSL_NTD_S->GetYaxis()->SetTitle("Counts / .05 keV");
//  h1_BSL_NTD_S->GetXaxis()->SetRangeUser( 0.0, 10.0);
//  h1_BSL_NTD_S->GetYaxis()->SetRangeUser(  0., 100.);
//  h1_BSL_NTD_S->SetLineColor(4);
//  h1_BSL_NTD_S->SetLineWidth(2);
//  h1_BSL_NTD_S->Draw();
//
//  TLegend *Legend_008 = new TLegend(.15,.70,.30,.85);
//  Legend_008->SetFillColor(0);
//  Legend_008->SetBorderSize(5);
//  Legend_008->AddEntry(h1_BSL_NTD_M,"NTD","L");
//  Legend_008->Draw();
//
//  Double_t NTD_BSL_RMS = 0.;
//  NTD_BSL_RMS = h1_BSL_NTD_S->GetMean();
//
//  cout << " Data entries = " << h1_BSL_NTD_S->GetMean() << " " << endl;
//  //cout << " NTD rate (cps) = " << h1_BSL_NTD_S->GetEntries()/RunTime << " +/- " << sqrt(h1_BSL_NTD_S->GetEntries())/RunTime << " " << endl;
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////
////                                                                         //
//// Canvas 011 :                                                            //
////                                                                         //
///////////////////////////////////////////////////////////////////////////////
//
//  cout << " ++++++++++++++++++++++++ " << endl;
//  cout << " ++++++ Canvas 011 ++++++ " << endl;
//  cout << " ++++++++++++++++++++++++ " << endl;
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  TCanvas *C_011 = new TCanvas("C_011","C_011: ", 1000,600);
//  C_011->Divide(1,1);
//  //  C_011->SetLogy();
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  gStyle->SetOptFit(000000);
//  gStyle->SetOptStat("000000001");
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  h2_Width_Amplitude->GetXaxis()->SetTitle("Rise Time [ms]");
//  h2_Width_Amplitude->GetYaxis()->SetTitle("Amplitude [V]");
//  h2_Width_Amplitude->GetXaxis()->SetRangeUser(  0.,  50.0);
//  h2_Width_Amplitude->GetYaxis()->SetRangeUser(  0.,  5.0);
//  h2_Width_Amplitude->SetLineColor(4);
//  h2_Width_Amplitude->SetLineWidth(2);
//  h2_Width_Amplitude->Draw();
//  /*
//  TLegend *Legend_011 = new TLegend(.55,.65,.85,.85);
//  Legend_011->SetFillColor(0);
//  Legend_011->SetBorderSize(5);
//  Legend_011->AddEntry(h1_Peak1,"Ge BOT","L");
//  Legend_011->Draw();
//
//  TLatex *Latex_011_1 = new TLatex( 511.,3000.,"511 keV");
//  Latex_011_1->SetTextSize(.030);
//  Latex_011_1->SetTextColor(1);
//  Latex_011_1->SetTextAlign(22);
//  Latex_011_1->Draw();
//
//  TLatex *Latex_011_2 = new TLatex(1461.,1000.,"1461 keV");
//  Latex_011_2->SetTextSize(.030);
//  Latex_011_2->SetTextColor(1);
//  Latex_011_2->SetTextAlign(22);
//  Latex_011_2->Draw();
//
//  TLatex *Latex_011_3 = new TLatex(2615., 200.,"2615 keV");
//  Latex_011_3->SetTextSize(.030);
//  Latex_011_3->SetTextColor(1);
//  Latex_011_3->SetTextAlign(22);
//  Latex_011_3->Draw();
//  */
//  /*
//  TLatex *Latex_011_4 = new TLatex( 200.,20000.,"59 keV");
//  Latex_011_4->SetTextSize(.030);
//  Latex_011_4->SetTextColor(1);
//  Latex_011_4->SetTextAlign(22);
//  Latex_011_4->Draw();
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////
////                                                                         //
//// Canvas 012 :                                                            //
////                                                                         //
///////////////////////////////////////////////////////////////////////////////
//
//  cout << " ++++++++++++++++++++++++ " << endl;
//  cout << " ++++++ Canvas 012 ++++++ " << endl;
//  cout << " ++++++++++++++++++++++++ " << endl;
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  TCanvas *C_012 = new TCanvas("C_012","C_012: ", 1000,600);
//  C_012->Divide(1,1);
//  C_012->SetLogy();
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  gStyle->SetOptFit(000000);
//  gStyle->SetOptStat("000000001");
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  h1_Peak2_keV->GetXaxis()->SetTitle("E [keV]");
//  h1_Peak2_keV->GetYaxis()->SetTitle("Counts / bin");
//  h1_Peak2_keV->GetXaxis()->SetRangeUser(  0.,   3000.);
//  h1_Peak2_keV->GetYaxis()->SetRangeUser(  1., 100000.);
//  h1_Peak2_keV->SetLineColor(4);
//  h1_Peak2_keV->SetLineWidth(2);
//  h1_Peak2_keV->Draw();
//
//  TLegend *Legend_012 = new TLegend(.55,.65,.85,.85);
//  Legend_012->SetFillColor(0);
//  Legend_012->SetBorderSize(5);
//  Legend_012->AddEntry(h1_Peak2,"Ge TOP","L");
//  Legend_012->Draw();
//
//  TLatex *Latex_012_1 = new TLatex( 511.,2000.,"511 keV");
//  Latex_012_1->SetTextSize(.030);
//  Latex_012_1->SetTextColor(1);
//  Latex_012_1->SetTextAlign(22);
//  Latex_012_1->Draw();
//
//  TLatex *Latex_012_2 = new TLatex(1461., 800.,"1461 keV");
//  Latex_012_2->SetTextSize(.030);
//  Latex_012_2->SetTextColor(1);
//  Latex_012_2->SetTextAlign(22);
//  Latex_012_2->Draw();
//
//  TLatex *Latex_012_3 = new TLatex(2615., 150.,"2615 keV");
//  Latex_012_3->SetTextSize(.030);
//  Latex_012_3->SetTextColor(1);
//  Latex_012_3->SetTextAlign(22);
//  Latex_012_3->Draw();
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////
////                                                                         //
//// Canvas 013 :                                                            //
////                                                                         //
///////////////////////////////////////////////////////////////////////////////
//
//  cout << " ++++++++++++++++++++++++ " << endl;
//  cout << " ++++++ Canvas 013 ++++++ " << endl;
//  cout << " ++++++++++++++++++++++++ " << endl;
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  TCanvas *C_013 = new TCanvas("C_013","C_013: ", 1000,600);
//  C_013->Divide(1,1);
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  gStyle->SetOptFit(000000);
//  gStyle->SetOptStat("000000001");
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  TH1F *h1_Peak1_keV_Am;
//  h1_Peak1_keV_Am = (TH1F*)h1_Peak1_keV->Clone();
//
//  h1_Peak1_keV_Am->GetXaxis()->SetTitle("E [keV]");
//  h1_Peak1_keV_Am->GetYaxis()->SetTitle("Counts / bin");
//  h1_Peak1_keV_Am->GetXaxis()->SetRangeUser(  0.,  100.0);
//  h1_Peak1_keV_Am->GetYaxis()->SetRangeUser(  0., 100000.);
//  h1_Peak1_keV_Am->SetLineColor(4);
//  h1_Peak1_keV_Am->SetLineWidth(2);
//  h1_Peak1_keV_Am->Draw();
//
//  TF1 *fit_Am = new TF1("fit_Am","pol1+gaus(2)",45.,75.);
//
//  fit_Am->SetParameters( 9.,-5.,69000.,59.5,3.0);
//  h1_Peak1_keV_Am->Fit("fit_Am","R");
//
//  TLegend *Legend_013 = new TLegend(.15,.65,.45,.85);
//  Legend_013->SetFillColor(0);
//  Legend_013->SetBorderSize(5);
//  Legend_013->AddEntry(h1_Peak1_keV_Am,"Ge BOT","L");
//  Legend_013->Draw();
//
//  TLatex *Latex_013 = new TLatex( 82.,35000.,"FWHM = 6.8 keV");
//  Latex_013->SetTextSize(.05);
//  Latex_013->SetTextColor(1);
//  Latex_013->SetTextAlign(22);
//  Latex_013->Draw();
//  */
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////
////                                                                         //
//// Canvas 021 :                                                            //
////                                                                         //
///////////////////////////////////////////////////////////////////////////////
//
//  cout << " ++++++++++++++++++++++++ " << endl;
//  cout << " ++++++ Canvas 021 ++++++ " << endl;
//  cout << " ++++++++++++++++++++++++ " << endl;
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  TCanvas *C_021 = new TCanvas("C_021","C_021: ", 1000,600);
//  C_021->Divide(1,1);
//  C_021->SetLogy();
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  gStyle->SetOptFit(000000);
//  gStyle->SetOptStat("000000001");
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  h1_NTD_1_MeV->GetXaxis()->SetTitle("E [MeV]");
//  h1_NTD_1_MeV->GetYaxis()->SetTitle("Counts / 10 keV");
//  h1_NTD_1_MeV->GetXaxis()->SetRangeUser(0.,   20.);
//  h1_NTD_1_MeV->GetYaxis()->SetRangeUser(1.,10000.);
//  h1_NTD_1_MeV->SetLineColor(4);
//  h1_NTD_1_MeV->SetLineWidth(2);
//  h1_NTD_1_MeV->Draw();
//
//  Int_t  N_NTD_T = h1_NTD_1_MeV->GetEntries();
//  cout << " ****** " << N_NTD_T << " " << endl;
//  Int_t N_NTD = N_NTD_T;
//  for (int j =  0; j < 5; j++) {
//    N_NTD = N_NTD - h1_NTD_1_MeV->GetBinContent(j + 1);
//    cout << " " << j << " " << h1_NTD_1_MeV->GetBinContent(j + 1) << " " << N_NTD << " " << endl;
//  }
//
//  h1_NTD_2_MeV->SetLineColor(2);
//  h1_NTD_2_MeV->SetFillColor(2);
//  h1_NTD_2_MeV->SetLineWidth(2);
//  h1_NTD_2_MeV->DrawCopy("SAME");
//
//  TLegend *Legend_021 = new TLegend(.65,.65,.85,.85);
//  Legend_021->SetFillColor(0);
//  Legend_021->SetBorderSize(5);
//  Legend_021->AddEntry(h1_NTD_1_MeV,"NTD","L");
//  Legend_021->AddEntry(h1_NTD_2_MeV,"NTD with Ge Veto" ,"L");
//  Legend_021->Draw();
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////
////                                                                         //
//// Canvas 022 :                                                            //
////                                                                         //
///////////////////////////////////////////////////////////////////////////////
//
//  cout << " ++++++++++++++++++++++++ " << endl;
//  cout << " ++++++ Canvas 022 ++++++ " << endl;
//  cout << " ++++++++++++++++++++++++ " << endl;
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  TCanvas *C_022 = new TCanvas("C_022","C_022: ", 1000,600);
//  C_022->Divide(1,1);
//  C_022->SetLogy();
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  gStyle->SetOptFit(000000);
//  gStyle->SetOptStat("000000001");
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  h1_NTD_1_MeV->GetXaxis()->SetTitle("E [MeV]");
//  h1_NTD_1_MeV->GetYaxis()->SetTitle("Counts / 10 keV");
//  h1_NTD_1_MeV->GetXaxis()->SetRangeUser(0.,   20.);
//  h1_NTD_1_MeV->GetYaxis()->SetRangeUser(1.,10000.);
//  h1_NTD_1_MeV->SetLineColor(4);
//  h1_NTD_1_MeV->SetLineWidth(2);
//  h1_NTD_1_MeV->Draw();
//
//  TH1F *h1_NTD_Veto_MeV;
//
//  h1_NTD_Veto_MeV = (TH1F*)h1_NTD_1_MeV->Clone();
//
//  h1_NTD_Veto_MeV->Add(h1_NTD_Veto_MeV,h1_NTD_2_MeV, 0., 1.);
//  h1_NTD_Veto_MeV->Add(h1_NTD_Veto_MeV,h1_NTD_3_MeV, 1., .5);
//  h1_NTD_Veto_MeV->Add(h1_NTD_Veto_MeV,h1_NTD_4_MeV, 1., .5);
//  h1_NTD_Veto_MeV->Add(h1_NTD_Veto_MeV,h1_NTD_5_MeV, 1.,-.5);
//
//  cout << " Veto " << h1_NTD_Veto_MeV->Integral(0,2005) << " " << endl;
//
//  h1_NTD_Veto_MeV->SetLineColor(2);
//  h1_NTD_Veto_MeV->SetFillColor(2);
//  h1_NTD_Veto_MeV->SetLineWidth(2);
//  h1_NTD_Veto_MeV->DrawCopy("SAME");
//
//  TLegend *Legend_022 = new TLegend(.65,.65,.85,.85);
//  Legend_022->SetFillColor(0);
//  Legend_022->SetBorderSize(5);
//  Legend_022->AddEntry(h1_NTD_1_MeV,"NTD","L");
//  Legend_022->AddEntry(h1_NTD_Veto_MeV,"NTD with Ge Veto" ,"L");
//  Legend_022->Draw();
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////
////                                                                         //
//// Canvas 023 :                                                            //
////                                                                         //
///////////////////////////////////////////////////////////////////////////////
//
//  cout << " ++++++++++++++++++++++++ " << endl;
//  cout << " ++++++ Canvas 023 ++++++ " << endl;
//  cout << " ++++++++++++++++++++++++ " << endl;
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  TCanvas *C_023 = new TCanvas("C_023","C_023: ", 1000,600);
//  C_023->Divide(1,1);
//  C_023->SetLogx();
//  C_023->SetLogy();
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  gStyle->SetOptFit(000000);
//  gStyle->SetOptStat("000000001");
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  TH1F *h1_P_COV1_Veto;
//  h1_P_COV1_Veto = (TH1F*)h1_P_COV1->Clone();
//  h1_P_COV1_Veto->Add(h1_P_COV1,h1_P_noCOV1, 1.,-0.5);
//
//  h1_P_COV1->GetXaxis()->SetTitle("E [MeV]");
//  h1_P_COV1->GetYaxis()->SetTitle("Counts / 10 keV");
//  h1_P_COV1->GetXaxis()->SetRangeUser(0.01,   20.);
//  h1_P_COV1->GetYaxis()->SetRangeUser(1.,10000.);
//  h1_P_COV1->SetLineColor(4);
//  h1_P_COV1->SetLineWidth(2);
//  h1_P_COV1->Draw();
//
//  h1_P_COV1_Veto->SetLineColor(2);
//  h1_P_COV1_Veto->SetFillColor(2);
//  h1_P_COV1_Veto->SetLineWidth(2);
//  h1_P_COV1_Veto->DrawCopy("SAME");
//
//  TLegend *Legend_023 = new TLegend(.55,.65,.85,.85);
//  Legend_023->SetFillColor(0);
//  Legend_023->SetBorderSize(5);
//  Legend_023->AddEntry(h1_P_COV1,"Ge BOT Veto","L");
//  Legend_023->AddEntry(h1_P_COV1_Veto,"Corrected Ge BOT Veto" ,"L");
//  Legend_023->Draw();
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////
////                                                                         //
//// Canvas 024 :                                                            //
////                                                                         //
///////////////////////////////////////////////////////////////////////////////
//
//  cout << " ++++++++++++++++++++++++ " << endl;
//  cout << " ++++++ Canvas 024 ++++++ " << endl;
//  cout << " ++++++++++++++++++++++++ " << endl;
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  TCanvas *C_024 = new TCanvas("C_024","C_024: ", 1000,600);
//  C_024->Divide(1,1);
//  C_024->SetLogx();
//  C_024->SetLogy();
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  gStyle->SetOptFit(000000);
//  gStyle->SetOptStat("000000001");
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  TH1F *h1_P_COV2_Veto;
//  h1_P_COV2_Veto = (TH1F*)h1_P_COV2->Clone();
//  h1_P_COV2_Veto->Add(h1_P_COV2,h1_P_noCOV2, 1.,-0.5);
//
//  h1_P_COV2->GetXaxis()->SetTitle("E [MeV]");
//  h1_P_COV2->GetYaxis()->SetTitle("Counts / 10 keV");
//  h1_P_COV2->GetXaxis()->SetRangeUser(0.01,   20.);
//  h1_P_COV2->GetYaxis()->SetRangeUser(1.,10000.);
//  h1_P_COV2->SetLineColor(4);
//  h1_P_COV2->SetLineWidth(2);
//  h1_P_COV2->Draw();
//
//  h1_P_COV2_Veto->SetLineColor(2);
//  h1_P_COV2_Veto->SetFillColor(2);
//  h1_P_COV2_Veto->SetLineWidth(2);
//  h1_P_COV2_Veto->DrawCopy("SAME");
//
//  TLegend *Legend_024 = new TLegend(.55,.65,.85,.85);
//  Legend_024->SetFillColor(0);
//  Legend_024->SetBorderSize(5);
//  Legend_024->AddEntry(h1_P_COV1,"Ge TOP Veto","L");
//  Legend_024->AddEntry(h1_P_COV1_Veto,"Corrected Ge TOP Veto" ,"L");
//  Legend_024->Draw();
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////
////                                                                         //
//// Canvas 041 :                                                            //
////                                                                         //
///////////////////////////////////////////////////////////////////////////////
//
//  cout << " ++++++++++++++++++++++++ " << endl;
//  cout << " ++++++ Canvas 041 ++++++ " << endl;
//  cout << " ++++++++++++++++++++++++ " << endl;
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  TCanvas *C_041 = new TCanvas("C_041","C_041: ", 1000,600);
//  C_041->Divide(1,1);
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  gStyle->SetOptFit(000000);
//  gStyle->SetOptStat("000000001");
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  h2_NTD_T1_T2->GetXaxis()->SetTitle("#DeltaT_{NTD - BOT} [ms]");
//  h2_NTD_T1_T2->GetYaxis()->SetTitle("#DeltaT_{NTD - TOP} [ms]");
//  h2_NTD_T1_T2->GetXaxis()->SetRangeUser(-50.,  50.);
//  h2_NTD_T1_T2->GetYaxis()->SetRangeUser(-50.,  50.);
//  h2_NTD_T1_T2->SetLineColor(4);
//  h2_NTD_T1_T2->SetLineWidth(2);
//  h2_NTD_T1_T2->Draw();
//
//  TLine *Line041_01 = new TLine(-32.,-50.,-32., 50.);
//  Line041_01->SetLineStyle(2);
//  Line041_01->SetLineColor(2);
//  Line041_01->SetLineWidth(4);
//  Line041_01->Draw();
//
//  TLine *Line041_02 = new TLine(-27.,-50.,-27., 50.);
//  Line041_02->SetLineStyle(2);
//  Line041_02->SetLineColor(2);
//  Line041_02->SetLineWidth(4);
//  Line041_02->Draw();
//
//  TLine *Line041_03 = new TLine( -2.,-50., -2., 50.);
//  Line041_03->SetLineStyle(2);
//  Line041_03->SetLineColor(4);
//  Line041_03->SetLineWidth(4);
//  Line041_03->Draw();
//
//  TLine *Line041_04 = new TLine(  3.,-50., 3., 50.);
//  Line041_04->SetLineStyle(2);
//  Line041_04->SetLineColor(4);
//  Line041_04->SetLineWidth(4);
//  Line041_04->Draw();
//
//  TLine *Line041_05 = new TLine( 28.,-50., 28., 50.);
//  Line041_05->SetLineStyle(2);
//  Line041_05->SetLineColor(2);
//  Line041_05->SetLineWidth(4);
//  Line041_05->Draw();
//
//  TLine *Line041_06 = new TLine( 33.,-50., 33., 50.);
//  Line041_06->SetLineStyle(2);
//  Line041_06->SetLineColor(2);
//  Line041_06->SetLineWidth(4);
//  Line041_06->Draw();
//
//  TLine *Line041_11 = new TLine(-17.,-17.,-17.,-12.);
//  Line041_11->SetLineStyle(2);
//  Line041_11->SetLineColor(2);
//  Line041_11->SetLineWidth(4);
//  Line041_11->Draw();
//
//  TLine *Line041_12 = new TLine(-17.,-12.,-12.,-12.);
//  Line041_12->SetLineStyle(2);
//  Line041_12->SetLineColor(2);
//  Line041_12->SetLineWidth(4);
//  Line041_12->Draw();
//
//  TLine *Line041_13 = new TLine(-12.,-17.,-12.,-12.);
//  Line041_13->SetLineStyle(2);
//  Line041_13->SetLineColor(2);
//  Line041_13->SetLineWidth(4);
//  Line041_13->Draw();
//
//  TLine *Line041_14 = new TLine(-17.,-17.,-12.,-17.);
//  Line041_14->SetLineStyle(2);
//  Line041_14->SetLineColor(2);
//  Line041_14->SetLineWidth(4);
//  Line041_14->Draw();
//
//  TLine *Line041_21 = new TLine( 18., 18., 18., 13.);
//  Line041_21->SetLineStyle(2);
//  Line041_21->SetLineColor(2);
//  Line041_21->SetLineWidth(4);
//  Line041_21->Draw();
//
//  TLine *Line041_22 = new TLine( 18., 13., 13., 13.);
//  Line041_22->SetLineStyle(2);
//  Line041_22->SetLineColor(2);
//  Line041_22->SetLineWidth(4);
//  Line041_22->Draw();
//
//  TLine *Line041_23 = new TLine( 13., 18., 13., 13.);
//  Line041_23->SetLineStyle(2);
//  Line041_23->SetLineColor(2);
//  Line041_23->SetLineWidth(4);
//  Line041_23->Draw();
//
//  TLine *Line041_24 = new TLine( 18., 18., 13., 18.);
//  Line041_24->SetLineStyle(2);
//  Line041_24->SetLineColor(2);
//  Line041_24->SetLineWidth(4);
//  Line041_24->Draw();
//
//  TLine *Line041_31 = new TLine(-50.,-32., 50.,-32.);
//  Line041_31->SetLineStyle(2);
//  Line041_31->SetLineColor(2);
//  Line041_31->SetLineWidth(4);
//  Line041_31->Draw();
//
//  TLine *Line041_32 = new TLine(-50.,-27., 50.,-27.);
//  Line041_32->SetLineStyle(2);
//  Line041_32->SetLineColor(2);
//  Line041_32->SetLineWidth(4);
//  Line041_32->Draw();
//
//  TLine *Line041_33 = new TLine(-50., -2., 50., -2.);
//  Line041_33->SetLineStyle(2);
//  Line041_33->SetLineColor(4);
//  Line041_33->SetLineWidth(4);
//  Line041_33->Draw();
//
//  TLine *Line041_34 = new TLine(-50.,  3., 50.,  3.);
//  Line041_34->SetLineStyle(2);
//  Line041_34->SetLineColor(4);
//  Line041_34->SetLineWidth(4);
//  Line041_34->Draw();
//
//  TLine *Line041_35 = new TLine(-50., 28., 50., 28.);
//  Line041_35->SetLineStyle(2);
//  Line041_35->SetLineColor(2);
//  Line041_35->SetLineWidth(4);
//  Line041_35->Draw();
//
//  TLine *Line041_36 = new TLine(-50., 33., 50., 33.);
//  Line041_36->SetLineStyle(2);
//  Line041_36->SetLineColor(2);
//  Line041_36->SetLineWidth(4);
//  Line041_36->Draw();
//
//  TLine *Line041_41 = new TLine(-17., 18.,-17., 13.);
//  Line041_41->SetLineStyle(2);
//  Line041_41->SetLineColor(2);
//  Line041_41->SetLineWidth(4);
//  Line041_41->Draw();
//
//  TLine *Line041_42 = new TLine(-17., 13.,-12., 13.);
//  Line041_42->SetLineStyle(2);
//  Line041_42->SetLineColor(2);
//  Line041_42->SetLineWidth(4);
//  Line041_42->Draw();
//
//  TLine *Line041_43 = new TLine(-12., 18.,-12., 13.);
//  Line041_43->SetLineStyle(2);
//  Line041_43->SetLineColor(2);
//  Line041_43->SetLineWidth(4);
//  Line041_43->Draw();
//
//  TLine *Line041_44 = new TLine(-17., 18.,-12., 18.);
//  Line041_44->SetLineStyle(2);
//  Line041_44->SetLineColor(2);
//  Line041_44->SetLineWidth(4);
//  Line041_44->Draw();
//
//  TLine *Line041_51 = new TLine( 18.,-17., 18.,-12.);
//  Line041_51->SetLineStyle(2);
//  Line041_51->SetLineColor(2);
//  Line041_51->SetLineWidth(4);
//  Line041_51->Draw();
//
//  TLine *Line041_52 = new TLine( 18.,-12., 13.,-12.);
//  Line041_52->SetLineStyle(2);
//  Line041_52->SetLineColor(2);
//  Line041_52->SetLineWidth(4);
//  Line041_52->Draw();
//
//  TLine *Line041_53 = new TLine( 13.,-17., 13.,-12.);
//  Line041_53->SetLineStyle(2);
//  Line041_53->SetLineColor(2);
//  Line041_53->SetLineWidth(4);
//  Line041_53->Draw();
//
//  TLine *Line041_54 = new TLine( 18.,-17., 13.,-17.);
//  Line041_54->SetLineStyle(2);
//  Line041_54->SetLineColor(2);
//  Line041_54->SetLineWidth(4);
//  Line041_54->Draw();
//
//  TLegend *Legend_041 = new TLegend(.15,.70,.35,.85);
//  Legend_041->SetFillColor(0);
//  Legend_041->SetBorderSize(5);
//  Legend_041->AddEntry(Line041_03,"In-time","L");
//  Legend_041->AddEntry(Line041_01,"Out-of-time","L");
//  Legend_041->Draw();
//
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////
////                                                                         //
//// Canvas 042 :                                                            //
////                                                                         //
///////////////////////////////////////////////////////////////////////////////
//
//  cout << " ++++++++++++++++++++++++ " << endl;
//  cout << " ++++++ Canvas 042 ++++++ " << endl;
//  cout << " ++++++++++++++++++++++++ " << endl;
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  TCanvas *C_042 = new TCanvas("C_042","C_042: ", 1000,600);
//  C_042->Divide(1,1);
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  gStyle->SetOptFit(000000);
//  gStyle->SetOptStat("000000001");
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  h1_DeltaT_NTD_COV1->GetXaxis()->SetTitle("#DeltaT [ms]");
//  h1_DeltaT_NTD_COV1->GetYaxis()->SetTitle("Counts / ms");
//  h1_DeltaT_NTD_COV1->GetXaxis()->SetRangeUser(-50.,  50.);
//  h1_DeltaT_NTD_COV1->GetYaxis()->SetRangeUser(  0.,4000.);
//  h1_DeltaT_NTD_COV1->SetLineColor(4);
//  h1_DeltaT_NTD_COV1->SetLineWidth(2);
//  h1_DeltaT_NTD_COV1->Draw();
//
//  Double_t SB = 0.;
//  for (int j =  75; j < 100; j++) {
//    SB = SB + 0.5*h1_DeltaT_NTD_COV1->GetBinContent(j+1);
//  }
//  for (int j = 155; j < 180; j++) {
//    SB = SB + 0.5*h1_DeltaT_NTD_COV1->GetBinContent(j+1);
//  }
//
//  Double_t SS = 0.;
//  for (int j = 115; j < 140; j++) {
//    SS = SS + h1_DeltaT_NTD_COV1->GetBinContent(j+1);
//  }
//  cout << " SS, SB = " << SS << " " << SB << " " << SS - SB << " " << endl;
//
///*
//  TLine *Line042_01 = new TLine(-32.,    0.,-32.,12000.);
//  Line042_01->SetLineStyle(2);
//  Line042_01->SetLineColor(2);
//  Line042_01->SetLineWidth(4);
//  Line042_01->Draw();
//
//  TLine *Line042_02 = new TLine(-22.,    0.,-22.,12000.);
//  Line042_02->SetLineStyle(2);
//  Line042_02->SetLineColor(2);
//  Line042_02->SetLineWidth(4);
//  Line042_02->Draw();
//
//  TLine *Line042_03 = new TLine( -6.,    0., -6.,12000.);
//  Line042_03->SetLineStyle(2);
//  Line042_03->SetLineColor(3);
//  Line042_03->SetLineWidth(4);
//  Line042_03->Draw();
//
//  TLine *Line042_04 = new TLine(  4.,    0.,  4.,12000.);
//  Line042_04->SetLineStyle(2);
//  Line042_04->SetLineColor(3);
//  Line042_04->SetLineWidth(4);
//  Line042_04->Draw();
//
//  TLine *Line042_05 = new TLine( 24.,    0., 24.,12000.);
//  Line042_05->SetLineStyle(2);
//  Line042_05->SetLineColor(2);
//  Line042_05->SetLineWidth(4);
//  Line042_05->Draw();
//
//  TLine *Line042_06 = new TLine( 34.,    0., 34.,12000.);
//  Line042_06->SetLineStyle(2);
//  Line042_06->SetLineColor(2);
//  Line042_06->SetLineWidth(4);
//  Line042_06->Draw();
//*/
//  TLegend *Legend_042 = new TLegend(.52,.72,.88,.88);
//  Legend_042->SetFillColor(0);
//  Legend_042->SetBorderSize(5);
//  Legend_042->AddEntry(h1_DeltaT_NTD_COV1,"T_{NTD}-T_{BOT}","L");
//  Legend_042->Draw();
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////
////                                                                         //
//// Canvas 043 :                                                            //
////                                                                         //
///////////////////////////////////////////////////////////////////////////////
//
//  cout << " ++++++++++++++++++++++++ " << endl;
//  cout << " ++++++ Canvas 043 ++++++ " << endl;
//  cout << " ++++++++++++++++++++++++ " << endl;
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  TCanvas *C_043 = new TCanvas("C_043","C_043: ", 1000,600);
//  C_043->Divide(1,1);
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  gStyle->SetOptFit(000000);
//  gStyle->SetOptStat("000000001");
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  h1_DeltaT_NTD_COV2->GetXaxis()->SetTitle("#DeltaT [ms]");
//  h1_DeltaT_NTD_COV2->GetYaxis()->SetTitle("Counts / ms");
//  h1_DeltaT_NTD_COV2->GetXaxis()->SetRangeUser(-50.,  50.);
//  h1_DeltaT_NTD_COV2->GetYaxis()->SetRangeUser(  0.,4000.);
//  h1_DeltaT_NTD_COV2->SetLineColor(4);
//  h1_DeltaT_NTD_COV2->SetLineWidth(2);
//  h1_DeltaT_NTD_COV2->Draw();
//
//  SB = 0.;
//  for (int j =  75; j < 100; j++) {
//    SB = SB + 0.5*h1_DeltaT_NTD_COV2->GetBinContent(j+1);
//  }
//  for (int j = 155; j < 180; j++) {
//    SB = SB + 0.5*h1_DeltaT_NTD_COV2->GetBinContent(j+1);
//  }
//
//  SS = 0.;
//  for (int j = 115; j < 140; j++) {
//    SS = SS + h1_DeltaT_NTD_COV2->GetBinContent(j+1);
//  }
//  cout << " SS, SB = " << SS << " " << SB << " " << SS - SB << " " << endl;
//
//
//
//  /*
//  TLine *Line043_01 = new TLine(-32.,    0.,-32.,12000.);
//  Line043_01->SetLineStyle(2);
//  Line043_01->SetLineColor(2);
//  Line043_01->SetLineWidth(4);
//  Line043_01->Draw();
//
//  TLine *Line043_02 = new TLine(-22.,    0.,-22.,12000.);
//  Line043_02->SetLineStyle(2);
//  Line043_02->SetLineColor(2);
//  Line043_02->SetLineWidth(4);
//  Line043_02->Draw();
//
//  TLine *Line043_03 = new TLine( -6.,    0., -6.,12000.);
//  Line043_03->SetLineStyle(2);
//  Line043_03->SetLineColor(3);
//  Line043_03->SetLineWidth(4);
//  Line043_03->Draw();
//
//  TLine *Line043_04 = new TLine(  4.,    0.,  4.,12000.);
//  Line043_04->SetLineStyle(2);
//  Line043_04->SetLineColor(3);
//  Line043_04->SetLineWidth(4);
//  Line043_04->Draw();
//
//  TLine *Line043_05 = new TLine( 24.,    0., 24.,12000.);
//  Line043_05->SetLineStyle(2);
//  Line043_05->SetLineColor(2);
//  Line043_05->SetLineWidth(4);
//  Line043_05->Draw();
//
//  TLine *Line043_06 = new TLine( 34.,    0., 34.,12000.);
//  Line043_06->SetLineStyle(2);
//  Line043_06->SetLineColor(2);
//  Line043_06->SetLineWidth(4);
//  Line043_06->Draw();
//  */
//  TLegend *Legend_043 = new TLegend(.52,.72,.88,.88);
//  Legend_043->SetFillColor(0);
//  Legend_043->SetBorderSize(5);
//  Legend_043->AddEntry(h1_DeltaT_NTD_COV2,"T_{NTD}-T_{TOP}","L");
//  Legend_043->Draw();
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////
////                                                                         //
//// Canvas 051 :                                                            //
////                                                                         //
///////////////////////////////////////////////////////////////////////////////
//
//  cout << " ++++++++++++++++++++++++ " << endl;
//  cout << " ++++++ Canvas 051 ++++++ " << endl;
//  cout << " ++++++++++++++++++++++++ " << endl;
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  TCanvas *C_051 = new TCanvas("C_051","C_051: ", 1000,600);
//  C_051->Divide(2,2);
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  gStyle->SetOptFit(000000);
//  gStyle->SetOptStat("000000001");
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
////  f_02->cd();
////
////  TH1F *h1_Raw_NTD_3, *h1_Raw_NTD_4, *h1_Dif_NTD_3, *h1_Dif_NTD_4;
////
////  C_051->cd(1);
////
////  h1_Raw_NTD_3 = (TH1F*)h1_NTD->Clone();
////  h1_Raw_NTD_3->GetXaxis()->SetTitle("T [ms]");
////  h1_Raw_NTD_3->GetYaxis()->SetTitle("Amplitude [V]");
////  h1_Raw_NTD_3->GetXaxis()->SetRangeUser(43700.,43900.);
////  h1_Raw_NTD_3->GetYaxis()->SetRangeUser( -3.0, 1.0);
////  h1_Raw_NTD_3->SetLineColor(4);
////  h1_Raw_NTD_3->SetLineWidth(2);
////  h1_Raw_NTD_3->Draw();
////
////  TLegend *Legend_051_1 = new TLegend(.65,.15,.85,.30);
////  Legend_051_1->SetFillColor(0);
////  Legend_051_1->SetBorderSize(5);
////  Legend_051_1->AddEntry(h1_Raw_NTD_3,"NTD","L");
////  Legend_051_1->Draw();
////
////  C_051->cd(3);
////
////  h1_Dif_NTD_3 = (TH1F*)h1_DIF_NTD->Clone();
////  h1_Dif_NTD_3->GetXaxis()->SetTitle("T [ms]");
////  h1_Dif_NTD_3->GetYaxis()->SetTitle("#DeltaAmplitude [V]");
////  h1_Dif_NTD_3->GetXaxis()->SetRangeUser(43700.,43900.);
////  h1_Dif_NTD_3->GetYaxis()->SetRangeUser( -1.0, 2.5);
////  h1_Dif_NTD_3->SetLineColor(4);
////  h1_Dif_NTD_3->SetLineWidth(2);
////  h1_Dif_NTD_3->Draw();
////
////  TLegend *Legend_051_3 = new TLegend(.65,.70,.85,.85);
////  Legend_051_3->SetFillColor(0);
////  Legend_051_3->SetBorderSize(5);
////  Legend_051_3->AddEntry(h1_Dif_NTD_3,"NTD","L");
////  Legend_051_3->Draw();
////
////  f_03->cd();
////
////  C_051->cd(2);
////
////  h1_Raw_NTD_4 = (TH1F*)h1_NTD->Clone();
////  h1_Raw_NTD_4->GetXaxis()->SetTitle("T [ms]");
////  h1_Raw_NTD_4->GetYaxis()->SetTitle("Amplitude [V]");
////  h1_Raw_NTD_4->GetXaxis()->SetRangeUser(43350.,43550.);
////  h1_Raw_NTD_4->GetYaxis()->SetRangeUser( -0.4, 0.8);
////  h1_Raw_NTD_4->SetLineColor(4);
////  h1_Raw_NTD_4->SetLineWidth(2);
////  h1_Raw_NTD_4->Draw();
////
////  TLegend *Legend_051_2 = new TLegend(.65,.15,.85,.30);
////  Legend_051_2->SetFillColor(0);
////  Legend_051_2->SetBorderSize(5);
////  Legend_051_2->AddEntry(h1_Raw_NTD_4,"NTD","L");
////  Legend_051_2->Draw();
////
////  C_051->cd(4);
////
////  h1_Dif_NTD_4 = (TH1F*)h1_DIF_NTD->Clone();
////  h1_Dif_NTD_4->GetXaxis()->SetTitle("T [ms]");
////  h1_Dif_NTD_4->GetYaxis()->SetTitle("#DeltaAmplitude [V]");
////  h1_Dif_NTD_4->GetXaxis()->SetRangeUser(43350.,43550.);
////  h1_Dif_NTD_4->GetYaxis()->SetRangeUser(-0.1,0.3);
////  h1_Dif_NTD_4->SetLineColor(4);
////  h1_Dif_NTD_4->SetLineWidth(2);
////  h1_Dif_NTD_4->Draw();
////
////  TLegend *Legend_051_4 = new TLegend(.65,.70,.85,.85);
////  Legend_051_4->SetFillColor(0);
////  Legend_051_4->SetBorderSize(5);
////  Legend_051_4->AddEntry(h1_Dif_NTD_4,"NTD","L");
////  Legend_051_4->Draw();
////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////
////  cout << " " << endl;
////  cout << " " << endl;
////  cout << " *************************** " << endl;
////  cout << " ***** Results Summary ***** " << endl;
////  cout << " *************************** " << endl;
////  cout << " " << endl;
////  cout << " ***********************************************************************************" << endl;
////  cout << " " << endl;
////  cout << " File name : " << file_name << " " << endl;
////  cout << " " << endl;
////  cout << " RunTime (s) = " ;
////  cout << fixed << setprecision(1) << setw(7) << setfill(' ') << RunTime << " (" ;
////  cout << fixed << setprecision(2) << setw(5) << setfill(' ') << RunTime/3600. << " h)" << endl;
////  cout << " NTD Threshold (keV) = " << int(NTD_Threshold) << " " << endl;
////  cout << " NTD events above threshold = " << N_NTD_T << "  ==> Rate (cps) = " ;
////  cout << fixed << setprecision(2) << setw(5) << setfill(' ') << N_NTD_T/RunTime << " +/- " ;
////  cout << fixed << setprecision(2) << setw(5) << setfill(' ') << sqrt(N_NTD_T)/RunTime << " " << endl;
////  cout << " NTD events above 50 keV    = " << N_NTD << "  ==> Rate (cps) = "  ;
////  cout << fixed << setprecision(2) << setw(5) << setfill(' ') << N_NTD/RunTime << " +/- " ;
////  cout << fixed << setprecision(2) << setw(5) << setfill(' ') << sqrt(N_NTD_T)/RunTime << " " << endl;
////  cout << " NTD Calibration Slope (mV/keV) = " ;
////  cout << fixed << setprecision(4) << setw(5) << setfill(' ') << 1000.*fit_01->GetParameter(1) << " +/- " ;
////  cout << fixed << setprecision(4) << setw(5) << setfill(' ') << 1000.*fit_01->GetParError(1) << " " << endl;
////  cout << " NTD Calibration Offset (mV) = " ;
////  cout << fixed << setprecision(3) << setw(5) << setfill(' ') << 1000.*fit_01->GetParameter(0) << " +/- " ;
////  cout << fixed << setprecision(3) << setw(5) << setfill(' ') << 1000.*fit_01->GetParError(0) << " " << endl;
////  cout << " NTD Gain = " << int(NTD_Gain) << " " << endl;
////  cout << " NTD Calibration Sensitivity (nV/keV) = " ;
////  cout << fixed << setprecision(1) << setw(4) << setfill(' ') << 1000.*fit_01->GetParameter(1)/(NTD_Gain/1000000.) << " " << endl;
////  cout << " NTD BSL mean (keV) = " ;
////  cout << fixed << setprecision(1) << setw(4) << setfill(' ') << NTD_BSL_RMS << " " << endl;
////  cout << " " << endl;
////  cout << " ***********************************************************************************" << endl;
////
 }


////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


